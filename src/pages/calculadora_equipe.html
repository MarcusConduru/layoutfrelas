<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/styles.css">
    <title>Calculadora de Equipe - iRUP</title>
    <style>
        /* Estilos gerais */
     

    </style>
</head>
<body>

    <div class="container">
        <div class="top-bar">
            <div class="help">Ajuda</div>
            <div class="user">Usuário1344</div>
        </div>
        <h1>Calculadora de Equipe</h1>
        <div class="content">
            <div class="data-observation">
            <label for="etapa">Etapa:</label>
            <select id="etapa" onchange="checkOutro(this)">
                    <option value="">Selecione a Etapa</option>
                    <option value="terraplanagem">Terraplanagem</option>
                    <option value="fundacao">Fundação</option>
                    <option value="estruturação_viga">Estruturação Viga</option>
                    <option value="estruturação_pilar">Estruturação Pilar</option>
                    <option value="estruturação_laje">Estruturação Laje</option>
                    <option value="alvenaria">Alvenaria</option>
                    <option value="cobertura">Cobertura</option>
                    <option value="estrutura_metalica">Estrutura metálica</option>
                    <option value="estrutura_madeira">Estrutura em madeira</option>
                    <option value="instalacao_metalica">Instalação Elétrica</option>
                    <option value="instalacao_hidraulica">Instalação Hidráulica</option>
                    <option value="instalacao_esgoto">Instalação de Esgoto</option>
                    <option value="revestimento">Revestimento</option>
                    <option value="pintura">Pintura</option>
                    <option value="forro">Forro</option>
                    <option value="piso">Piso</option>
                    <option value="esquadria">Esquadria</option>
                    <option value="forros">Forros</option>
                    <option value="outro">Outro</option>
            </select>
            </div>
            <div id="outroEtapa" style="display: none;">
                <label for="outro">Outra Etapa:</label>
                <input type="text" id="outro" placeholder="Digite a etapa">
            </div>
                <div class="data-observation">
                <label for="hora-diaria">Hora Diária:</label>
                <input type="number" id="hora-diaria" placeholder="Insira as horas diárias">
            </div>

            <div class="data-observation">
                <label for="qt-servico">Qt. de Serviço:</label>
                <input type="number" id="qt-servico" placeholder="Insira a quantidade de serviço">
            </div>

            <div class="data-observation">
                <label for="rup-potencial">RUP Potencial:</label>
                <input type="number" id="rup-potencial" placeholder="Insira o RUP potencial">
            </div>

            <div class="buttons2">
                <button onclick="calcularEquipe()">Calcular</button>
                <button onclick="exportToCSV()">Salvar como CSV</button>
                <button onclick="location.href='menu.html'">Voltar</button>
            </div>

            <p class="result">Resultado: <span id="resultado">--</span></p>
        </div>
    </div>

    <script>
        function checkOutro(select) {
                const outroEtapa = document.getElementById('outroEtapa');
                    if (select.value === 'outro') {
                    outroEtapa.style.display = 'block';
                    } else {
                            outroEtapa.style.display = 'none';
                            }
                    }

        function calcularEquipe() {
            const horaDiaria = parseFloat(document.getElementById('hora-diaria').value);
            const qtServico = parseFloat(document.getElementById('qt-servico').value);
            const rupPotencial = parseFloat(document.getElementById('rup-potencial').value);

            if (isNaN(horaDiaria) || isNaN(qtServico) || isNaN(rupPotencial)) {
                document.getElementById('resultado').textContent = "Preencha os campos corretamente";
            } else {
                const quantidadeHomens = Math.round((rupPotencial * qtServico) / horaDiaria);
                document.getElementById('resultado').textContent = quantidadeHomens.toFixed(2) + ' homens necessários na equipe';
            }
        }

        function exportToCSV() {
    const horaDiaria = document.getElementById('hora-diaria').value;
    const qtServico = document.getElementById('qt-servico').value;
    const rupPotencial = document.getElementById('rup-potencial').value;
    const quantidadeHomens = document.getElementById('resultado').textContent;
    let etapa = document.getElementById('etapa').value;
    const outraEtapa = document.getElementById('outro').value;

    // Ajusta o valor de 'etapa' para incluir a entrada do campo 'Outro'
    if (etapa === 'Outro') {
        etapa = outraEtapa;
    }

    if (horaDiaria && qtServico && rupPotencial) {
        // Criação do conteúdo para o arquivo CSV
        const csvContent = `Hora Diária;Quantidade de Serviço;RUP Potencial;Etapa;Homens Necessários\n${horaDiaria};${qtServico};${rupPotencial};${etapa};${quantidadeHomens}`;

        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        if (link.download !== undefined) {
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'calculadora_equipe.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        } else {
            console.error('A funcionalidade de download não é suportada pelo seu navegador.');
        }
    }
}



    </script>
</body>
</html>
